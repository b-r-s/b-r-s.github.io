/* Checkerboard Styles */
.board-with-advantage {
  display: flex;
  align-items: flex-start;
  justify-content: center;
}

.checkerboard {
  display: grid;
  margin-top: 9.6vw;
  grid-template-columns: repeat(8, 1fr);
  grid-template-rows: repeat(8, 1fr);
  gap: 0;
  width: 40vw;
  aspect-ratio: 1;
  height: 40vw;
  max-width: 600px;
  max-height: 600px;
  border-radius: 4px;
  margin-left: 2vw;
  touch-action: none;
  user-select: none;
  -webkit-user-select: none;
}

.board-square {
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
  /* Removed transition to prevent "multiple squares lit" artifact */
}

.board-square.light {
  background: var(--board-light);
  /* white squares */
}

.board-square.dark {
  background: var(--board-dark);
  /* blue squares */
}

v

/* Prevent any hover effects on non-interactive squares */
.board-square.dark:not(.valid-move):not(.hover-valid-move) {
  cursor: default;
}

.board-square.valid-move {
  cursor: pointer;
  box-shadow: inset 0 0 20px rgba(147, 51, 234, 0.5);
}

.board-square.hover-valid-move {
  box-shadow: inset 0 0 15px rgba(147, 51, 234, 0.3);
}

.board-square.valid-move::after,
.board-square.hover-valid-move::after {
  content: '';
  position: absolute;
  width: 30%;
  height: 30%;
  background-color: rgba(255, 255, 255);
  border-radius: 50%;
  animation: pulse 1.5s ease-in-out infinite;
  pointer-events: none;
  /* Crucial for drag and drop to work through the indicator */
}

/* Removed .move-indicator rule as it's no longer used */

.board-square.selected {
  box-shadow: inset 0 0 30px rgba(251, 191, 36, 0.8);
}

.board-square.gold-border {
  /* Use outline to sit outside/on top of box-shadows without overriding them */
  outline: 4px solid #FFD700;
  outline-offset: -4px;
  z-index: 10;
}

.board-square.piece-hovered {
  filter: brightness(1.1);
}

.board-square.hover-glow {
  box-shadow: inset 0 0 25px rgba(74, 222, 128, 0.7);
  animation: glow-pulse 1.2s ease-in-out infinite;
}

@keyframes glow-pulse {

  0%,
  100% {
    box-shadow: inset 0 0 25px rgba(0, 0, 0, 0.5);
  }

  50% {
    box-shadow: inset 0 0 35px rgba(0, 0, 0, 0.9);
  }
}

@keyframes pulse {

  0%,
  100% {
    transform: scale(1);
    opacity: 0.7;
  }

  50% {
    transform: scale(1.2);
    opacity: 1;
  }
}

/* AI Jump Trail - Start Square (green border) */
.board-square.ai-trail-start {
  outline: 4px solid #22c55e !important;
  outline-offset: -4px;
  z-index: 10;
}

/* AI Jump Trail - Captured Squares (red border + Amethyst X) */
.board-square.ai-trail-captured {
  outline: 4px solid #ef4444 !important;
  outline-offset: -4px;
  z-index: 9;
}

.board-square.ai-trail-captured::before {
  content: '' !important;
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 70%;
  height: 70%;
  background-image: url('../../assets/captured-x.svg');
  background-size: contain;
  background-repeat: no-repeat;
  background-position: center;
  pointer-events: none;
  filter: drop-shadow(0 0 4px rgba(0, 0, 0, 0.8));
  z-index: 15;
  visibility: visible !important;
  display: block !important;
}

/* AI Jump Trail - Landing Squares (pulsing amethyst glow) */
.board-square.ai-trail-landing {
  z-index: 8;
  animation: landing-pulse 2s ease-in-out infinite;
}

@keyframes landing-pulse {

  0%,
  100% {
    box-shadow: inset 0 0 15px rgba(147, 51, 234, 0.4);
  }

  50% {
    box-shadow: inset 0 0 35px rgba(147, 51, 234, 0.7);
  }
}

/* Overlay for connecting lines using dynamic stacked gradients */
.trail-path-overlay {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  pointer-events: none;
  z-index: 5;
  opacity: 0.9;
  background-repeat: no-repeat;
  background-size: 100% 100%;
}

/* If a square has BOTH, we'll handle it via an extra class or multiple backgrounds in inline style if needed, 
   but for now let's just fix the directions which were the main issue. */

/* AI Move Highlighting - Fix animation to stay visible */
.board-square.ai-move-highlight {
  animation: blinkBorderPersistent 1s ease-in-out infinite;
  z-index: 12;
}

@keyframes blinkBorderPersistent {

  0%,
  100% {
    outline: 5px solid #00ff00;
    box-shadow: 0 0 20px #00ff00, inset 0 0 10px rgba(0, 255, 0, 0.3);
  }

  50% {
    outline: 2px solid #00ff00;
    box-shadow: 0 0 10px #00ff00;
  }
}

/* Jump Hint Arrow for Beginner Level */
.jump-hint-arrow {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  font-size: 2.5vw;
  pointer-events: none;
  z-index: 8;
  animation: jump-hint-pulse 1s ease-in-out infinite;
  filter: drop-shadow(0 0 4px rgba(255, 255, 255, 0.8));
}

@keyframes jump-hint-pulse {

  0%,
  100% {
    transform: translate(-50%, -50%) scale(1);
    opacity: 1;
  }

  50% {
    transform: translate(-50%, -50%) scale(1.2);
    opacity: 0.8;
  }
}

@keyframes blinkBorder {

  0%,
  25%,
  50%,
  75% {
    border: 5px solid #00ff00;
    /* Bright Green */
    box-shadow: 0 0 20px #00ff00, inset 0 0 20px rgba(0, 255, 0, 0.3);
  }

  12.5%,
  37.5%,
  62.5%,
  87.5% {
    border: 5px solid transparent;
    box-shadow: none;
  }

  100% {
    border: 5px solid transparent;
    box-shadow: none;
  }
}

/* Undo Move Highlight */
.board-square.undo-move-highlight {
  animation: blinkBorderUndo 1.2s ease-in-out forwards;
  z-index: 5;
}

@keyframes blinkBorderUndo {

  0%,
  25%,
  50%,
  75% {
    border: 5px solid #f59e0b;
    /* Bright Orange */
    box-shadow: 0 0 20px #f59e0b, inset 0 0 20px rgba(245, 158, 11, 0.3);
  }

  12.5%,
  37.5%,
  62.5%,
  87.5% {
    border: 5px solid transparent;
    box-shadow: none;
  }

  100% {
    border: 5px solid transparent;
    box-shadow: none;
  }
}

/* Toast Notification */
.toast-notification {
  position: absolute;
  top: 10%;
  left: 50%;
  transform: translateX(-50%);
  background-color: rgba(0, 0, 0, 0.85);
  color: white;
  padding: 12px 24px;
  border-radius: 8px;
  font-size: 1.1rem;
  z-index: 2000;
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
  pointer-events: none;
  animation: fadeInOut 3s ease-in-out forwards;
  text-align: center;
  white-space: nowrap;
}

@keyframes fadeInOut {
  0% {
    opacity: 0;
    transform: translate(-50%, -20px);
  }

  10% {
    opacity: 1;
    transform: translate(-50%, 0);
  }

  90% {
    opacity: 1;
    transform: translate(-50%, 0);
  }

  100% {
    opacity: 0;
    transform: translate(-50%, -20px);
  }
}

/* Mobile Responsive Board Styles */
@media (max-width: 1024px) {
  .checkerboard {
    width: 70vw;
    height: 70vw;
    margin-left: 0;
    margin-top: 1rem;
    /* border-width: 12px; */
  }
}

@media (max-width: 768px) {
  .checkerboard {
    width: 85vw;
    height: 85vw;
    margin-top: 0.5rem;
    /* border-width: 10px;
    box-shadow: 0 6px 0 #0a0f1a,
      0 12px 0 #0f172a,
      0 18px 0 #1a1f2e,
      0 30px 40px rgba(0, 0, 0, 0.7); */
  }

  .board-square.valid-move::after,
  .board-square.hover-valid-move::after {
    width: 40%;
    height: 40%;
  }

  .toast-notification {
    font-size: 0.95rem;
    padding: 10px 20px;
    top: 5%;
  }
}

@media (max-width: 480px) {
  .checkerboard {
    width: 92vw;
    height: 92vw;
    margin-top: 0.25rem;
    /* border-width: 8px;
    box-shadow: 0 4px 0 #0a0f1a,
      0 8px 0 #0f172a,
      0 12px 0 #1a1f2e,
      0 20px 30px rgba(0, 0, 0, 0.7); */
  }

  .board-square.valid-move::after,
  .board-square.hover-valid-move::after {
    width: 50%;
    height: 50%;
  }

  .toast-notification {
    font-size: 0.85rem;
    padding: 8px 16px;
    top: 3%;
  }

  .board-square.ai-move-highlight {
    border-width: 3px;
  }

  .jump-hint-arrow {
    font-size: 6vw;
  }

  @keyframes blinkBorder {

    0%,
    25%,
    50%,
    75% {
      border: 3px solid #00ff00;
      box-shadow: 0 0 15px #00ff00, inset 0 0 15px rgba(0, 255, 0, 0.3);
    }

    12.5%,
    37.5%,
    62.5%,
    87.5% {
      border: 3px solid transparent;
      box-shadow: none;
    }

    100% {
      border: 3px solid transparent;
      box-shadow: none;
    }
  }
}

/* Touch-friendly improvements */
@media (hover: none) and (pointer: coarse) {
  .board-square {
    cursor: pointer;
  }

  .board-square.valid-move:active {
    background-color: rgba(147, 51, 234, 0.15);
  }

  .board-square:active {
    transition: background-color 0.1s;
  }
}